{% extends "base.html" %}
{% block content %}

<div class="detail-container">
  <div class="detail-header">
    <div class="detail-type-badge">
      {% if material.material_type == 'book' %}üìö –ö–∏—Ç–æ–±
      {% elif material.material_type == 'app' %}üì± –ë–∞—Ä–Ω–æ–º–∞
      {% elif material.material_type == 'image' %}üñºÔ∏è –†–∞—Å–º
      {% elif material.material_type == 'video' %}üé¨ –í–∏–¥–µ–æ
      {% endif %}
    </div>
    <h2 class="detail-title">{{ material.title }}</h2>
  </div>

  <div class="detail-grid">
    <div class="detail-main">
      {% if material.author %}
        <div class="detail-info-row">
          <span class="info-label">üë§ –ú—É–∞–ª–ª–∏—Ñ/–û—Ñ–∞—Ä–∏–¥–≥–æ—Ä:</span>
          <span class="info-value">{{ material.author }}</span>
        </div>
      {% endif %}

      {% if uploader %}
        <div class="detail-info-row">
          <span class="info-label">üì§ –ë–æ—Ä–≥—É–∑–æ—Ä”£ –∞–∑ “∑–æ–Ω–∏–±–∏:</span>
          <span class="info-value">{{ uploader.name }}</span>
        </div>
      {% endif %}

      {% if material.created_at %}
        <div class="detail-info-row">
          <span class="info-label">üìÖ –°–∞–Ω–∞–∏ –±–æ—Ä–≥—É–∑–æ—Ä”£:</span>
          <span class="info-value">{{ material.created_at[:10] }} {{ material.created_at[11:16] }}</span>
        </div>
      {% endif %}

      <div class="detail-info-row">
        <span class="info-label">üëÅÔ∏è –î–∏–¥–∞ —à—É–¥:</span>
        <span class="info-value">{{ material.view_count }} –º–∞—Ä–æ—Ç–∏–±–∞</span>
      </div>

      <div style="height:24px"></div>

      <div class="detail-description-section">
        <h4>üìù –¢–∞–≤—Å–∏—Ñ</h4>
        <div class="detail-description">
          {{ material.description if material.description else "–¢–∞–≤—Å–∏—Ñ –¥–∞—Å—Ç—Ä–∞—Å –Ω–µ—Å—Ç." }}
        </div>
      </div>

      <div style="height:24px"></div>

      <div class="detail-actions">
        {% if material.filename %}
          <a class="btn btn-large btn-download" href="{{ url_for('download_file', filename=material.filename) }}">
            ‚¨áÔ∏è –ë–æ—Ä–≥–∏—Ä”£
          </a>
        {% else %}
          <div class="no-file-notice">
            ‚ö†Ô∏è –§–∞–π–ª –±–æ—Ä–≥—É–∑–æ—Ä”£ –Ω–∞—à—É–¥–∞–∞—Å—Ç
          </div>
        {% endif %}

        <a class="btn btn-secondary" href="{{ url_for('materials', material_type=material.material_type) }}">
          ‚Üê –ë–∞—Ä–≥–∞—à—Ç
        </a>
      </div>
    </div>

    <div class="detail-sidebar">
      <div class="sidebar-card">
        <h4>‚ÑπÔ∏è –ú–∞—ä–ª—É–º–æ—Ç–∏ –ò–ª–æ–≤–∞–≥”£</h4>
        
        {% if material.filename %}
          <div class="sidebar-info">
            <span class="sidebar-label">üìé –§–∞–π–ª:</span>
            <span class="sidebar-value">{{ material.filename }}</span>
          </div>
        {% endif %}

        <div class="sidebar-info">
          <span class="sidebar-label">üè∑Ô∏è –ù–∞–≤—ä:</span>
          <span class="sidebar-value">
            {% if material.material_type == 'book' %}–ö–∏—Ç–æ–±
            {% elif material.material_type == 'app' %}–ë–∞—Ä–Ω–æ–º–∞
            {% elif material.material_type == 'image' %}–†–∞—Å–º
            {% elif material.material_type == 'video' %}–í–∏–¥–µ–æ
            {% endif %}
          </span>
        </div>

        <div class="sidebar-info">
          <span class="sidebar-label">üÜî ID:</span>
          <span class="sidebar-value">#{{ material.id }}</span>
        </div>
      </div>

      {% if session.get('admin_level') and session.get('admin_level') >= 1 %}
        <div class="sidebar-card admin-actions">
          <h4>‚öôÔ∏è –ê–º–∞–ª“≥–æ–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</h4>
          
          {% if session.get('admin_level') == 2 or material.uploaded_by == session.get('user_id') %}
            <a class="btn btn-edit" href="{{ url_for('admin_edit_material', material_id=material.id) }}">
              ‚úèÔ∏è –¢–∞“≥—Ä–∏—Ä
            </a>
            
            <a class="btn btn-stats" href="{{ url_for('admin_material_stats', material_id=material.id) }}">
              üìä –û–º–æ—Ä
            </a>
            
            <a class="btn btn-delete" href="{{ url_for('admin_delete_material', material_id=material.id) }}" 
               onclick="return confirm('–ú–∞–≤–æ–¥—Ä–æ –Ω–µ—Å—Ç –∫–∞—Ä–¥–∞–Ω –¥–∞—Ä–∫–æ—Ä–º–∏?')">
              üóëÔ∏è –ù–µ—Å—Ç –∫–∞—Ä–¥–∞–Ω
            </a>
          {% else %}
            <p class="small">–®—É–º–æ —Ç–∞–Ω“≥–æ –º–µ—Ç–∞–≤–æ–Ω–µ–¥ –º–∞–≤–æ–¥“≥–æ–∏ —Ö—É–¥—Ä–æ –Ω–∞–∑–æ—Ä–∞—Ç –∫—É–Ω–µ–¥.</p>
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}
