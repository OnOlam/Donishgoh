{% extends "base.html" %}
{% block content %}

<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <div class="auth-icon">‚ú®</div>
      <h2 class="auth-title">“ö–∞–π–¥ –∫–∞—Ä–¥–∞–Ω</h2>
      <p class="auth-subtitle">“≤–∏—Å–æ–±–∏ –Ω–∞–≤ —ç“∑–æ–¥ –∫—É–Ω–µ–¥ –≤–∞ –æ“ì–æ–∑ –∫—É–Ω–µ–¥</p>
    </div>

    <form method="post" action="{{ url_for('register') }}" class="auth-form" onsubmit="return validateForm()">
      <div class="form-group">
        <label class="form-label">
          <span class="label-icon">üë§</span>
          <span>–ù–æ–º—É –Ω–∞—Å–∞–±–∏ –ø—É—Ä—Ä–∞–∏ —à—É–º–æ</span>
        </label>
        <input 
          class="input" 
          type="text" 
          name="name" 
          id="nameInput"
          placeholder="–ù–æ–º –≤–∞ –ù–∞—Å–∞–±" 
          required 
          minlength="3"
          autocomplete="name"
        >
        <span class="form-hint">“≤–∞–¥–¥–∏ –∞“õ–∞–ª 3 “≥–∞—Ä—Ñ</span>
      </div>

      <div class="form-group">
        <label class="form-label">
          <span class="label-icon">üìß</span>
          <span>–°—É—Ä–æ“ì–∞–∏ Gmail</span>
        </label>
        <input 
          class="input" 
          type="email" 
          name="email" 
          id="emailInput"
          placeholder="—à—É–º–æ@gmail" 
          required 
          autocomplete="email"
        >
        <span class="form-hint">–°—É—Ä–æ“ì–∞–∏ –ø–æ—á—Ç–∞–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∏ –¥—É—Ä—É—Å—Ç—Ä–æ –≤–æ—Ä–∏–¥ –∫—É–Ω–µ–¥.</span>
      </div>

      <div class="form-group">
        <label class="form-label">
          <span class="label-icon">üîë</span>
          <span>–ö–∞–ª–∏–¥–≤–æ–∂–∞ —Å–æ–∑–µ–¥</span>
        </label>
        <div class="password-input-wrapper">
          <input 
            class="input" 
            type="password" 
            name="password" 
            id="registerPassword"
            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
            required 
            minlength="6"
            autocomplete="new-password"
            oninput="checkPasswordStrength()"
          >
          <button 
            type="button" 
            class="password-toggle" 
            onclick="togglePassword('registerPassword', this)"
            aria-label="Parolni ko'rsatish/yashirish"
          >
            üëÅÔ∏è
          </button>
        </div>
        <div class="password-strength">
          <div class="strength-bar" id="strengthBar"></div>
        </div>
        <span class="form-hint" id="strengthText">–ë–æ—è–¥ “≥–∞–¥–¥–∏ –∞“õ“õ–∞–ª 6 –∞–ª–æ–º–∞—Ç –¥–∞—Ä–æ–∑”£ –¥–æ—à—Ç–∞ –±–æ—à–∞–¥</span>
      </div>

      <div class="form-group">
        <label class="form-label">
          <span class="label-icon">üîí</span>
          <span>–ö–∞–ª–∏–¥–≤–æ–∂–∞—Ä–æ —Ç–∞—Å–¥–∏“õ –∫—É–Ω–µ–¥</span>
        </label>
        <div class="password-input-wrapper">
          <input 
            class="input" 
            type="password" 
            name="password_confirm" 
            id="confirmPassword"
            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
            required 
            autocomplete="new-password"
            oninput="checkPasswordMatch()"
          >
          <button 
            type="button" 
            class="password-toggle" 
            onclick="togglePassword('confirmPassword', this)"
            aria-label="Parolni ko'rsatish/yashirish"
          >
            üëÅÔ∏è
          </button>
        </div>
        <span class="form-hint" id="matchText"></span>
      </div>

      <div class="form-agreement">
        <label class="checkbox-label">
          <input type="checkbox" required>
          <span>–ú–∞–Ω <a href="#" class="auth-link">–®–∞—Ä—Ç“≥–æ–∏ –∏—Å—Ç–∏—Ñ–æ–¥–∞</a> –≤–∞ <a href="#" class="auth-link">–°–∏—ë—Å–∞—Ç–∏ –ö–æ—Ä–±—É—Ä–¥–∏ –ú–∞—ä–ª—É–º–æ—Ç–∏ –®–∞—Ö—Å”£</a> –ú–∞–Ω –±–æ –æ–Ω —Ä–æ–∑”£ “≥–∞—Å—Ç–∞–º</span>
        </label>
      </div>

      <button class="btn btn-large btn-success auth-submit" type="submit">
        <span class="btn-icon">üéâ</span>
        “ö–∞–π–¥ –∫–∞—Ä–¥–∞–Ω
      </button>
    </form>

    <div class="auth-divider">
      <span>—ë</span>
    </div>

    <div class="auth-footer">
      <p class="auth-footer-text">
        –û—ë —à—É–º–æ –∞–ª–ª–∞–∫–∞–π “≥–∏—Å–æ–± –¥–æ—Ä–µ–¥?
        <a href="{{ url_for('login') }}" class="auth-link">
          –î–∞—Ä–æ–º–∞–¥–∞–Ω ‚Üí
        </a>
      </p>
    </div>
  </div>

  <div class="auth-benefits">
    <h3 class="benefits-title">–ß–∞—Ä–æ –º–æ—Ä–æ –∏–Ω—Ç–∏—Ö–æ–± –∫—É–Ω–µ–¥?</h3>
    
    <div class="benefit-item">
      <div class="benefit-icon">‚úÖ</div>
      <div class="benefit-text">
        <h4>100% —Ä–æ–π–≥–æ–Ω</h4>
        <p>“≤–∞–º–∞–∏ –º–∞–≤–æ–¥“≥–æ —Ä–æ–π–≥–æ–Ω –∑–µ—Ä–∫–∞—à”£ –∫–∞—Ä–¥–∞ –º–µ—à–∞–≤–∞–Ω–¥</p>
      </div>
    </div>

    <div class="benefit-item">
      <div class="benefit-icon">üöÄ</div>
      <div class="benefit-text">
        <h4>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —à–∞–≤–µ–¥</h4>
        <p>–ò—Å—Ç–∏—Ñ–æ–¥–∞–±–∞—Ä–∞–Ω–¥–∞–≥–æ–Ω–∏ —Ñ–∞—ä–æ–ª “≥—É“õ—É“õ“≥–æ–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä”£ —Ö–æ“≥–∞–Ω–¥ –¥–æ—à—Ç</p>
      </div>
    </div>

    <div class="benefit-item">
      <div class="benefit-icon">üì§</div>
      <div class="benefit-text">
        <h4>–ú–∞–≤–æ–¥—Ä–æ –±–æ—Ä –∫—É–Ω–µ–¥</h4>
        <p>–ú–∞–≤–æ–¥“≥–æ–∏ —Ö—É–¥—Ä–æ –±–æ –¥–∏–≥–∞—Ä–æ–Ω –º—É–±–æ–¥–∏–ª–∞ –∫—É–Ω–µ–¥</p>
      </div>
    </div>

    <div class="benefit-item">
      <div class="benefit-icon">üìä</div>
      <div class="benefit-text">
        <h4>–û–º–æ—Ä</h4>
        <p>–ü–∞–π–≥–∏—Ä”£ –∫—É–Ω–µ–¥, –∫–∏ –º–∞–≤–æ–¥–∏ —à—É–º–æ —á–∞–Ω–¥ –º–∞—Ä–æ—Ç–∏–±–∞ —Ç–∞–º–æ—à–æ —à—É–¥–∞–∞—Å—Ç</p>
      </div>
    </div>
  </div>
</div>

<script>
function togglePassword(inputId, button) {
  const input = document.getElementById(inputId);
  if (input.type === 'password') {
    input.type = 'text';
    button.textContent = 'üôà';
  } else {
    input.type = 'password';
    button.textContent = 'üëÅÔ∏è';
  }
}

function checkPasswordStrength() {
  const password = document.getElementById('registerPassword').value;
  const strengthBar = document.getElementById('strengthBar');
  const strengthText = document.getElementById('strengthText');
  
  let strength = 0;
  if (password.length >= 6) strength++;
  if (password.length >= 8) strength++;
  if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;
  if (/\d/.test(password)) strength++;
  if (/[^a-zA-Z0-9]/.test(password)) strength++;
  
  const colors = ['#ef4444', '#f59e0b', '#eab308', '#22c55e', '#10b981'];
  const texts = ['Juda zaif', 'Zaif', "O'rtacha", 'Kuchli', 'Juda kuchli'];
  const widths = ['20%', '40%', '60%', '80%', '100%'];
  
  if (password.length === 0) {
    strengthBar.style.width = '0%';
    strengthText.textContent = 'Kamida 6 ta belgidan iborat bo\'lsin';
    strengthText.style.color = '#94a3b8';
  } else {
    strengthBar.style.width = widths[strength];
    strengthBar.style.backgroundColor = colors[strength];
    strengthText.textContent = texts[strength];
    strengthText.style.color = colors[strength];
  }
  
  checkPasswordMatch();
}

function checkPasswordMatch() {
  const password = document.getElementById('registerPassword').value;
  const confirm = document.getElementById('confirmPassword').value;
  const matchText = document.getElementById('matchText');
  
  if (confirm.length === 0) {
    matchText.textContent = '';
    return;
  }
  
  if (password === confirm) {
    matchText.textContent = '‚úì Parollar mos keldi';
    matchText.style.color = '#10b981';
  } else {
    matchText.textContent = '‚úó Parollar mos kelmayapti';
    matchText.style.color = '#ef4444';
  }
}

function validateForm() {
  const password = document.getElementById('registerPassword').value;
  const confirm = document.getElementById('confirmPassword').value;
  
  if (password !== confirm) {
    alert('‚ùå –ü–∞—Ä–æ–ª“≥–æ –±–æ “≥–∞–º –º—É–≤–æ—Ñ–∏“õ–∞—Ç –Ω–∞–º–µ–∫—É–Ω–∞–Ω–¥!');
    return false;
  }
  
  if (password.length < 6) {
    alert('‚ùå –ü–∞—Ä–æ–ª –±–æ—è–¥ “≥–∞–¥–¥–∏ –∞“õ“õ–∞–ª 6 –∞–ª–æ–º–∞—Ç –¥–æ—à—Ç–∞ –±–æ—à–∞–¥!');
    return false;
  }
  
  return true;
}
</script>

{% endblock %}
