{% extends "base.html" %}
{% block content %}

<div class="stats-container">
  <div class="stats-header">
    <h2>üìä –û–º–æ—Ä–∏ –º–∞–≤–æ–¥</h2>
    <a class="btn btn-secondary" href="{{ url_for('admin') }}">‚Üê –ë–∞—Ä–≥–∞—à—Ç</a>
  </div>

  <div style="height:24px"></div>

  <div class="stats-material-info">
    <div class="stats-info-card">
      <h3>{{ material.title }}</h3>
      <div class="stats-meta">
        <span class="meta-badge">
          {% if material.material_type == 'book' %}üìö –ö–∏—Ç–æ–±
          {% elif material.material_type == 'app' %}üì± –ë–∞—Ä–Ω–æ–º–∞
          {% elif material.material_type == 'image' %}üñºÔ∏è –†–∞—Å–º
          {% elif material.material_type == 'video' %}üé¨ –í–∏–¥–µ–æ
          {% endif %}
        </span>
        {% if material.author %}
          <span class="meta-item">üë§ {{ material.author }}</span>
        {% endif %}
        <span class="meta-item">üìÖ {{ material.created_at[:10] }}</span>
      </div>
    </div>

    <div class="stats-summary">
      <div class="stats-box">
        <div class="stats-number">{{ material.view_count }}</div>
        <div class="stats-label">–®—É–º–æ—Ä–∞–∏ —É–º—É–º–∏–∏ —Ç–∞–º–æ—à–æ–±–∏–Ω–æ–Ω</div>
      </div>
      <div class="stats-box">
        <div class="stats-number">{{ views|length }}</div>
        <div class="stats-label">–ò—Å—Ç–∏—Ñ–æ–¥–∞–±–∞—Ä–∞–Ω–¥–∞–≥–æ–Ω</div>
      </div>
    </div>
  </div>

  <div style="height:32px"></div>

  <div class="stats-section">
    <h3>üë• –¢–∞—ä—Ä–∏—Ö—Ä–æ –¥–∏–¥–∞–Ω</h3>
    
    {% if views %}
      <div class="views-list">
        {% for v in views %}
          <div class="view-item">
            <div class="view-user">
              <span class="view-icon">üë§</span>
              <span class="view-name">
                {% if v.name %}
                  {{ v.name }}
                {% else %}
                  –ö–æ—Ä–±–∞—Ä–∏ –º–µ“≥–º–æ–Ω
                {% endif %}
              </span>
            </div>
            <div class="view-time">
              <span class="view-icon">üïí</span>
              <span>{{ v.viewed_at[:10] }} {{ v.viewed_at[11:16] }}</span>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty-state-small">
        <p>üì≠ “≤–æ–ª–æ –∫–∞—Å–µ –æ–Ω—Ä–æ –Ω–∞–¥–∏–¥–∞–∞—Å—Ç..</p>
      </div>
    {% endif %}
  </div>

  <div style="height:24px"></div>

  <div class="stats-actions">
    <a class="btn btn-primary" href="{{ url_for('material_detail', material_id=material.id) }}" target="_blank">
      üëÅÔ∏è –ú–∞–≤–æ–¥—Ä–æ –±–∏–Ω–µ–¥
    </a>
    <a class="btn btn-edit" href="{{ url_for('admin_edit_material', material_id=material.id) }}">
      ‚úèÔ∏è –¢–∞“≥—Ä–∏—Ä
    </a>
  </div>
</div>

{% endblock %}
